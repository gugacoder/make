<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>PackDm</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  body {
    font-family: "Helvetica Neue", Helvetica, arial, sans;
    max-width: 900px;
    margin: auto;
    color: #515151;
    padding-bottom: 50px;
    font-size: 12pt;
  }
  
  p {
    text-align: justify;
  }
  
  h1 a, h1 a:visited,
  h2 a, h2 a:visited,
  h3 a, h3 a:visited,
  h4 a, h4 a:visited,
  h5 a, h5 a:visited {
    color: #515151;
    text-decoration: none;
  }
  
  blockquote {
    border-left: 2px solid lightgray;
    padding-left: 10px;
    font-style: italic;
  }
  
  table {
    border-collapse: collapse;
    margin-bottom: 20px;
  }
  
  colgroup {
    display: none;
  }
  
  td, th {
    padding: 4px 8px 4px 8px;
  }
  
  td {
    border: 1px solid #eee;
  }
  
  li {
    margin-top: 4px;
    margin-bottom: 4px;
  }
  
  code, pre {
    font-size: 12pt;
  }
  
  pre code {
    padding: 0px 2px 0px 2px;
    color: #555;
    background-color: #eee;
    border: 1px solid #ddd;
    border-radius: 2px;
    padding: none;
    color: inherit;
    background-color: inherit;
    border: none;
  }
  
  pre {
    padding: 10px;
    color: #555;
    background-color: #eee;
    border: 1px solid #ddd;
    border-radius: 2px;
  }
  
  hr {
    border: 0px;
    border-bottom: 1px solid #eee;
    margin-bottom: 0px;
    margin-top: 20px;
  }
  
  .figure {
    display: inline-block;
    text-align: center;
  }
  
  .vermelho {
    padding-left: 4px;
    padding-right: 4px;
    background-color: #d40000;
    color: white;
  }
  
  #TOC {
    margin: 30px 0px 20px 20px;
    float: right;
    border: 1px solid #eee;
    background-color: #f8f8f8;
  }
  
  #TOC li {
    padding-left: 10px;
    padding-right: 10px;
  }
  
  #TOC>ul {
    padding: 0px;
  }
  
  #TOC>ul>li {
    display: block;
  }
  
  </style>
</head>
<body>
<nav id="TOC">
<ul>
<li><a href="#packdm">PackDm</a><ul>
<li><a href="#visão-geral">Visão Geral</a></li>
<li><a href="#instalação-e-uso">Instalação e Uso</a></li>
<li><a href="#repositório-central">Repositório Central</a></li>
<li><a href="#nomenclatura-de-artefato">Nomenclatura de Artefato</a></li>
<li><a href="#o-arquivo-pack.info">O arquivo <code>pack.info</code></a></li>
<li><a href="#a-ferramenta-pack-bootstrap.exe">A ferramenta <code>pack-bootstrap.exe</code></a></li>
<li><a href="#a-ferramenta-pack.exe">A ferramenta <code>pack.exe</code></a></li>
<li><a href="#operações-do-cliente">Operações do cliente</a><ul>
<li><a href="#iniciando-o-projeto-do-artefato">1. Iniciando o projeto do artefato</a></li>
<li><a href="#instalando-as-dependências-do-projeto">2. Instalando as dependências do projeto</a></li>
<li><a href="#empacotando-o-artefato">3. Empacotando o artefato</a></li>
<li><a href="#publicando-o-artefato-no-repositório-do-packdm">4. Publicando o artefato no repositório do PackDm</a></li>
</ul></li>
<li><a href="#operações-do-serviço">Operações do serviço</a><ul>
<li><a href="#indexando-o-repositório">1. Indexando o repositório</a></li>
<li><a href="#lançando-o-serviço-de-publicação-do-repositório">2. Lançando o serviço de publicação do repositório</a></li>
</ul></li>
<li><a href="#intervalos-de-versão">Intervalos de Versão</a><ul>
<li><a href="#de-um-inicio-a-um-fim">1. De um inicio a um fim</a></li>
<li><a href="#igual-até-ou-a-partir-de">2. Igual, até ou a partir de</a></li>
<li><a href="#compativel-com-a-versão-maior">3. Compativel com a versão maior</a></li>
<li><a href="#compatível-com-a-versão-de-patch">4. Compatível com a versão de patch</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="packdm">PackDm</h1>
<p>Gerenciador de dependências simplificado.</p>
<h2 id="visão-geral">Visão Geral</h2>
<p>O PackDm gerencia o empacotamento de artefatos, a publicação destes artefatos no repositório e o download das dependências do projeto. A ferramenta de linha de comando <code>pack</code> é capaz tanto de executar as operações do cliente do repositório quanto lançar o serviço de publicação do repositório.</p>
<h2 id="instalação-e-uso">Instalação e Uso</h2>
<ol type="1">
<li>Baixe o <a href="http://keepcoding.net/pack/updater/pack-bootstrap.exe">pack-bootstrap.exe</a> para a pasta do projeto e commite este arquivo junto do projeto.</li>
<li>Execute o pack-bootstrap.exe para obter automaticamente uma cópia atualizada do pack.exe.</li>
<li>Execute <code>pack.exe init</code> para iniciar o projeto.</li>
<li>Edit o arquivo <code>pack.info</code> e acrescente as dependências do projeto.</li>
<li>Execute <code>pack.exe install</code> para instalar as dependências na pasta <code>Deps</code>.</li>
<li>Execute <code>pack.exe pack deploy</code> quando o artefato estiver pronto para ser publicado no servidor do PackDm.</li>
</ol>
<h2 id="repositório-central">Repositório Central</h2>
<p>O repositório central do PackDm contém os artefatos já publicados e o arquivo de índice do repositório usado pela ferramenta <code>pack</code> para resolver dependências.</p>
<p>O repositório do PackDm está hospedado em:</p>
<ul>
<li><a href="http://keepcoding.net/pack/repository/">http://keepcoding.net/pack/repository/</a></li>
</ul>
<p>Com uma porta alternativa em:</p>
<ul>
<li><a href="http://keepcoding.net:8585">http://keepcoding.net:8585</a></li>
</ul>
<p>Outros recursos relacionados ao PackDm pode ser obtidos em:</p>
<ul>
<li><a href="http://keepcoding.net/pack/">http://keepcoding.net/pack/</a></li>
</ul>
<h2 id="nomenclatura-de-artefato">Nomenclatura de Artefato</h2>
<p>Um artefato do PackDm é nomeado da seguinte forma:</p>
<pre><code>Grupo/Artefato/0.0.0</code></pre>
<p><code>Grupo</code> em geral é um de:</p>
<ul>
<li><code>KeepCoding</code>, para artefatos criados pela própria KeepCoding.</li>
<li><code>3rd-party</code>, para artefatos de terceiros.</li>
</ul>
<p><code>Artefato</code> corresponde ao nome do artefato em PascalCase geralmente refletindo o nome do assembly. Por exemplo;</p>
<ul>
<li><code>PackDm</code></li>
<li><code>KeepCoding.Sandbox</code></li>
</ul>
<p><code>0.0.0</code> corresponde ao número de versão do artefato no formato:</p>
<pre><code>major.minor.patch</code></pre>
<p>Conforme definição do <a href="http://semver.org/">Versionamento Semântico</a>. Quando necessário a versão pode ser sucedida de uma nota de release separada por hífen, por exemplo:</p>
<pre><code>1.0.0-alpha
1.0.0-alpha.1
1.0.0-beta
1.0.0-beta.1
etc.</code></pre>
<h2 id="o-arquivo-pack.info">O arquivo <code>pack.info</code></h2>
<p>O arquivo <code>pack.info</code> contém três definições fundamentais de um artefato do PackDm:</p>
<ul>
<li><code>pack</code>, O nome do artefato;</li>
<li><code>deps</code>, A declaração dos nomes das dependências do artefato;</li>
<li><code>dist</code>, A declaração dos arquivos que compõem o artefato.</li>
</ul>
<p>Exemplo do arquivo <code>pack.info</code>:</p>
<pre><code>pack
  Sandbox/Exemplo/1.0.0
deps
  Sandbox/UmArtefato/^1.0.0
  Sandbox/OutroArtefato/~0.1.0
dist
  LEIAME.md
  **/*.dll
  **/*.exe
  **/*.xml</code></pre>
<p>A endentação dos valores de cada seção em dois espaços é necessária.</p>
<p>Dois curingas são suportados:</p>
<ul>
<li><code>*</code> Pode ser usado para indicar qualquer quantidade de caracter na posição.</li>
<li><code>**</code> Pode ser usado para indicar pastas e subpastas.</li>
</ul>
<p>Exemplos de uso dos curingas</p>
<p>Todos os arquivos da pasta, não considerando subpastas:</p>
<pre><code>dist
  *
  </code></pre>
<p>Todos os arquivos da pasta e das subpastas:</p>
<pre><code>dist
  **
  </code></pre>
<p>Todos os arquivos das subpastas, não considerando a própria pasta:</p>
<pre><code>dist
  */**
  </code></pre>
<p>Todos os executáveis e todas as DLLs da pasta e subpastas:</p>
<pre><code>dist
  **/*.exe
  **/*.dll</code></pre>
<h2 id="a-ferramenta-pack-bootstrap.exe">A ferramenta <code>pack-bootstrap.exe</code></h2>
<p>O <code>pack-bootstrap.exe</code> é o comando responsável por manter uma cópia atualizada do <code>pack.exe</code> na pasta do projeto e pode ser obtido do endereço:</p>
<ul>
<li><a href="http://keepcoding.net/pack/updater/pack-bootstrap.exe">http://keepcoding.net/pack/updater/pack-bootstrap.exe</a></li>
</ul>
<p>O <code>pack-bootstrap.exe</code> deve ser copiado para a raiz do projeto que será gerenciado e pode e deve ser comitado junto com o projeto.</p>
<p>Quando executado diretamente sem parâmetros o <code>pack-bootstrap.exe</code> copia a versão mais recente do <code>pack.exe</code> encontrada nos repositórios do PackDm.</p>
<p>O arquivo <code>pack.exe</code> não precisa e não deve ser commitado junto com o projeto.</p>
<p>Para mais informações sobre o <code>pack-bootstrap.exe</code> use:</p>
<pre><code>pack-bootstrap.exe --help</code></pre>
<h2 id="a-ferramenta-pack.exe">A ferramenta <code>pack.exe</code></h2>
<p>O <code>pack.exe</code> tem duas finalidades básicas:</p>
<ul>
<li>Gerenciar as operações de cliente do PackDm.</li>
<li>Lançar o servidor de repositório do PackDm.</li>
</ul>
<p>As próximas seções tratam dos dois aspectos em separado.</p>
<p>Um detalhamento completo das operações oferecidas pelo <code>pack.exe</code> pode ser obtida pela execução:</p>
<pre><code>pack.exe --help</code></pre>
<h2 id="operações-do-cliente">Operações do cliente</h2>
<p>Do ponto de vista do cliente o <code>pack.exe</code> é usado para:</p>
<ol type="1">
<li>Iniciar o projeto de artefato;</li>
<li>Instalar as dependências do artefato;</li>
<li>Empacotar o artefato;</li>
<li>Publicar o artefato empacotado no repositório do PackDm.</li>
</ol>
<h3 id="iniciando-o-projeto-do-artefato">1. Iniciando o projeto do artefato</h3>
<p>Comando:</p>
<pre><code>pack.exe init</code></pre>
<p>Depois de iniciado dois arquivos são incluídos na pasta do projeto:</p>
<ul>
<li><code>pack.info</code>, contendo as definições do artefato</li>
<li><code>pack.conf</code>, contendo configurações de uso do <code>pack.exe</code>.</li>
</ul>
<p>O primeiro arquivo deve ser editado e definido:</p>
<ul>
<li>A seção <code>pack</code> com o nome do artefato.</li>
<li>A seção <code>deps</code> contendo a declaração de nomes dos artefatos dependentes.</li>
</ul>
<p>O <code>pack.exe</code> suporta intervalo de versões para as dependências do artefato. Para mais detalhes consulte a seção Intervalos de Versão.</p>
<h3 id="instalando-as-dependências-do-projeto">2. Instalando as dependências do projeto</h3>
<p>Comando:</p>
<pre><code>pack.exe install</code></pre>
<p>O <code>pack.exe</code> é capaz de baixar tanto as dependências declaradas no arquivo <code>pack.info</code> quanto as dependências das dependências recursivamente. O <code>pack.exe</code> compora os intervalos de versão entre todos os artefatos encontrados e tenta determinar a versão mais recente que atende a todos eles. Apenas uma versão de cada dependência é baixa no fim e publicada na pasta <code>Deps</code> do projeto.</p>
<h3 id="empacotando-o-artefato">3. Empacotando o artefato</h3>
<p>Comando:</p>
<pre><code>pack.exe pack [ --set-version x.x.x ]</code></pre>
<p>O <code>pack.exe</code> produz uma cópia do arquivo <code>pack.info</code> dentro da pasta <code>Dist</code> do projeto e indexa na seção <code>dist</code> do arquivo todos os arquivos encontrados na pasta <code>Dist</code>.</p>
<p>Em geral o comando <code>pack</code> deve ser executado depois da compilação do projeto para preparar o pacote do artefato que será submetido ao repositório do PackDm.</p>
<p>O parâmetro <code>--set-version</code> permite modificar a versão do arquivo <code>pack.info</code> copiado. O curinga <code>x</code> corresponde pode ser usado para manter valor atual daquela porção da versão.</p>
<p>Abaixo segue um exemplo da aplicação de <code>--set-version</code> para produzir um número modificado de versão:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Versão</th>
<th style="text-align: left;">Máscara</th>
<th style="text-align: left;">Versão Obtida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>1</code></td>
<td style="text-align: left;"><code>2</code></td>
<td style="text-align: left;"><code>2.0.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>1</code></td>
<td style="text-align: left;"><code>x.2</code></td>
<td style="text-align: left;"><code>1.2.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>1</code></td>
<td style="text-align: left;"><code>x.x.2</code></td>
<td style="text-align: left;"><code>1.0.2</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>1.4</code></td>
<td style="text-align: left;"><code>2</code></td>
<td style="text-align: left;"><code>2.4.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>1.4</code></td>
<td style="text-align: left;"><code>x.2</code></td>
<td style="text-align: left;"><code>1.2.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>1.4</code></td>
<td style="text-align: left;"><code>x.x.2</code></td>
<td style="text-align: left;"><code>1.4.2</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>1.4.8</code></td>
<td style="text-align: left;"><code>2</code></td>
<td style="text-align: left;"><code>2.4.8</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>1.4.8</code></td>
<td style="text-align: left;"><code>x.2</code></td>
<td style="text-align: left;"><code>1.2.8</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>1.4.8</code></td>
<td style="text-align: left;"><code>x.x.2</code></td>
<td style="text-align: left;"><code>1.4.2</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>1.4.8</code></td>
<td style="text-align: left;"><code>3.2.1</code></td>
<td style="text-align: left;"><code>3.2.1</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>1.4.8</code></td>
<td style="text-align: left;"><code>x.x.x-alpha</code></td>
<td style="text-align: left;"><code>1.4.8-alpha</code></td>
</tr>
</tbody>
</table>
<h3 id="publicando-o-artefato-no-repositório-do-packdm">4. Publicando o artefato no repositório do PackDm</h3>
<p>Comando:</p>
<pre><code>pack.exe deploy</code></pre>
<p>O <code>pack.exe</code> publica o arquivo <code>Dist/pack.info</code> e todos os arquivos declarados na seção <code>dist</code> dele no repositório do PackDm.</p>
<h2 id="operações-do-serviço">Operações do serviço</h2>
<p>O <code>pack.exe</code> oferece duas operações fundamentais para o serviço do PackDm:</p>
<ol type="1">
<li>Indexador do repositório;</li>
<li>Lançador do serviço de publicação do repsitório.</li>
</ol>
<p>O repositório em geral é estocado na pasta:</p>
<pre><code>{userdir}/.pack/repository</code></pre>
<p>Sendo <code>{userdir}</code> o caminho da pasta de perfil do usuário. Embora a pasta possa ser redefinida no arquivo <code>pack.conf</code>.</p>
<h3 id="indexando-o-repositório">1. Indexando o repositório</h3>
<p>Comando:</p>
<pre><code>pack.exe index</code></pre>
<p>O índice é produzido no arquivo <code>pack.index</code> na raiz do repositório e contém o nome completa de cada artefato encontrado no repositório.</p>
<p>Exemplo do arquivo <code>pack.index</code>:</p>
<pre><code>#
# Índice do repositório.
#
# 09/06/2016 17:17:22
#

Sandbox/Exemplo/1.0.0
Sandbox/Exemplo/1.0.1
Sandbox/Exemplo/1.0.2</code></pre>
<h3 id="lançando-o-serviço-de-publicação-do-repositório">2. Lançando o serviço de publicação do repositório</h3>
<p>Comando:</p>
<pre><code>pack.exe serve [--port PORTA] [--folder REPOSITORIO]</code></pre>
<p>O serviço é lançado por padrão na porta <code>8585</code> mas pode ser refinida na linha de comando ou no arquivo <code>pack.conf</code>.</p>
<p>A pasta do repositório pode também ser redefinida na linha de comando ou no arquivo <code>pack.conf</code>.</p>
<h2 id="intervalos-de-versão">Intervalos de Versão</h2>
<p>A versão pode ser definida em intervalos:</p>
<h3 id="de-um-inicio-a-um-fim">1. De um inicio a um fim</h3>
<p>Qualquer versão maior ou igual ao início e menor ou igual ao fim. Exemplos:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Versão</th>
<th style="text-align: left;">Intervalo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>1 - 2</code></td>
<td style="text-align: left;"><code>&gt;= 1.0.0 e &lt;= 2.0.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>1.2 - 3.4</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.0 e &lt;= 3.4.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>1.2.3 - 3.4.5</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.3 e &lt;= 3.4.5</code></td>
</tr>
</tbody>
</table>
<p>O espaço antes e depois do hífen é fundamental.</p>
<h3 id="igual-até-ou-a-partir-de">2. Igual, até ou a partir de</h3>
<p>Qualquer versão igual a indicada, até a indicada ou a partir da indicada, segundo os operadores:</p>
<ul>
<li><code>=</code> Igual à versão indicada.</li>
<li><code>&gt;</code> Maior que a versão indicada.</li>
<li><code>&lt;</code> Menor que a versão indicada.</li>
<li><code>&gt;=</code> Maior ou igual à versão indicada.</li>
<li><code>&lt;=</code> Menor ou igual à versão indicada.</li>
</ul>
<p>Exemplos:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Versão</th>
<th style="text-align: left;">Intervalo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>=1</code></td>
<td style="text-align: left;"><code>= 1.0.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>=1.2</code></td>
<td style="text-align: left;"><code>= 1.2.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>=1.2.3</code></td>
<td style="text-align: left;"><code>= 1.2.3</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&gt;1</code></td>
<td style="text-align: left;"><code>&gt; 1.0.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&gt;=1.2</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&lt;=1.2.3</code></td>
<td style="text-align: left;"><code>&lt;= 1.2.3</code></td>
</tr>
</tbody>
</table>
<h3 id="compativel-com-a-versão-maior">3. Compativel com a versão maior</h3>
<p>Qualquer versão superior à versão declarada até a última versão do primeiro digito não zero. Exemplos:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Versão</th>
<th style="text-align: left;">Intervalo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>^1</code></td>
<td style="text-align: left;"><code>&gt;= 1.0.0 e &lt; 2.0.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>^1.2</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.0 e &lt; 2.0.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>^1.2.3</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.3 e &lt; 2.0.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>^0.1.2</code></td>
<td style="text-align: left;"><code>&gt;= 0.1.2 e &lt; 0.2.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>^0.0.1</code></td>
<td style="text-align: left;"><code>&gt;= 0.0.1 e &lt; 0.0.2</code></td>
</tr>
</tbody>
</table>
<h3 id="compatível-com-a-versão-de-patch">4. Compatível com a versão de patch</h3>
<p>Qualquer versão compatível com a versão declarada. A compatibilidade é definida no nível do <code>patch</code>. Exemplos:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Versão</th>
<th style="text-align: left;">Intervalo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>~1</code></td>
<td style="text-align: left;"><code>&gt;= 1.0.0 e &lt; 2.0.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>~1.2</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.0 e &lt; 1.3.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>~1.2.3</code></td>
<td style="text-align: left;"><code>&gt;= 1.2.3 e &lt; 1.3.0</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>~0.1.2</code></td>
<td style="text-align: left;"><code>&gt;= 0.1.2 e &lt; 0.2.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>~0.0.1</code></td>
<td style="text-align: left;"><code>&gt;= 0.0.1 e &lt; 0.1.0</code></td>
</tr>
</tbody>
</table>
</body>
</html>
